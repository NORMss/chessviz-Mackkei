APP = chess
APPPATH = bin/$(APP)

CFLAGS = -Wall -Werror
CPPFLAGS = -I src -MMD
CC = gcc

SOURCES = board_read.c move.c board_print_plain.c board.c
MAINS = main.c
OBJECTS = $(SOURCES:.c=.o)
MAINO = $(APPS:.c=.o)

SOURCEPATH = $(src/libchessviz/SOURCES)
OBJPATH = obj/src/libchessviz/$(OBJECTS)
SRCMAINPATH = src/chessviz/$(MAINS)
OBJMAINPATH = obj/src/chessviz/$(MAINO)

LIB = libchessviz.a
LIBPATH = obj/src/libchessviz/$(LIB)


HEADERS = $(SOURCES:.c=.d)



all: $(APPPATH)

$(APPPATH): $(OBJMAINPATH) $(LIBPATH)
	$(CC) $(CFLAGS) -o $@ $^
	
$(OBJMAINPATH): $(SRCMAINPATH)
	$(CC) $(CFLAGS) $(CPPFLAGS) -c -o $@ $<
	
$(LIBPATH): $(OBJPATH)
	ar rcs $@ $^
	
$(OBJPATH): $(SOURCES)
	$(CC) $(CFLAGS) $(CPPFLAGS) -c -o $@ $<
	
-include $(HEADERS)

.PHONY: all install uninstall clean

clean:
	rm obj/src/*/*.o
	rm bin/chess
	rm obj/src/libchessviz/libchessviz.a
